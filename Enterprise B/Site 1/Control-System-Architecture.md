# Enterprise B - Site 1 Beverage Facility
# Control System Architecture and Control Narratives

> **DISCLAIMER: AI-GENERATED DOCUMENT**
>
> This document was generated by artificial intelligence (Claude AI) for demonstration and educational purposes only. All control system specifications, PLC configurations, and technical details are simulated based on data from a Unified Namespace (UNS) demonstration environment. This document should NOT be used for actual engineering, procurement, or construction purposes without thorough review and validation by qualified professional engineers. No warranty is provided for accuracy or fitness for any particular purpose.

**Document Number:** ENT-B-S1-CS-001
**Revision:** A
**Date:** 2026-01-09
**Prepared By:** Controls Engineering
**Approved By:** _______________

---

## Table of Contents

1. [Executive Summary](#1-executive-summary)
2. [PLC/DCS Architecture](#2-plcdcs-architecture)
3. [Control Narratives](#3-control-narratives)
4. [Interlocks and Permissives](#4-interlocks-and-permissives)
5. [Communication Networks](#5-communication-networks)
6. [Operator Interface Requirements](#6-operator-interface-requirements)
7. [Alarm Philosophy](#7-alarm-philosophy)
8. [Appendices](#8-appendices)

---

## 1. Executive Summary

This document defines the control system architecture and control narratives for Enterprise B - Site 1, a beverage manufacturing facility comprising four primary production areas:

- **Liquid Processing:** Mix room with 4 mixing vats and tank storage with 6 storage tanks
- **Filler Production:** 3 parallel filling lines (Washer-Filler-Caploader sequences)
- **Packaging:** 4 parallel labeling/packaging lines (Labeler-Packager-Sealer sequences)
- **Palletizing:** 2 automated robotic palletizers and 4 manual palletizing stations

The control system architecture follows ISA-95 Level 2 standards with integration to Level 3 MES systems via a Unified Namespace (UNS) architecture using MQTT protocol.

---

## 2. PLC/DCS Architecture

### 2.1 System Overview

The facility employs a distributed control architecture with area-based PLCs communicating through an industrial Ethernet backbone. The architecture is designed for:
- High availability in critical process areas
- Modular expansion capability
- Seamless MES/ERP integration via UNS
- Comprehensive safety system integration

### 2.2 Controller Allocation

```
+------------------------------------------------------------------+
|                    ENTERPRISE B - SITE 1                          |
|                   CONTROL SYSTEM TOPOLOGY                         |
+------------------------------------------------------------------+
                              |
                    [Plant Network Switch]
                    (Managed Layer 3 Switch)
                              |
        +----------+----------+----------+----------+
        |          |          |          |          |
   [LP-PLC-01] [FP-PLC-01] [PK-PLC-01] [PZ-PLC-01]
   Liquid Proc  Filler Prod  Packaging   Palletizing
        |          |          |          |
   [LP-SAF-01] [FP-SAF-01] [PK-SAF-01] [PZ-SAF-01]
   Safety PLC   Safety PLC  Safety PLC  Safety PLC
```

#### 2.2.1 Liquid Processing Area

| Controller | Tag | Platform | Description |
|------------|-----|----------|-------------|
| LP-PLC-01 | Liquid Processing Main | Allen-Bradley ControlLogix L85E | Mix room and tank storage control |
| LP-SAF-01 | Liquid Processing Safety | Allen-Bradley GuardLogix L73S | Safety interlocks for liquid processing |
| LP-RIO-01 | Mix Room Remote I/O | 1756-EN2T + I/O Modules | VAT-01 through VAT-04 |
| LP-RIO-02 | Tank Storage Remote I/O | 1756-EN2T + I/O Modules | TK-01 through TK-06 |

**I/O Estimate - Liquid Processing:**

| Equipment | DI | DO | AI | AO | Total |
|-----------|----|----|----|----|-------|
| VAT-01 to VAT-04 (x4) | 32 | 24 | 16 | 8 | 80 |
| TK-01 to TK-06 (x6) | 36 | 24 | 24 | 12 | 96 |
| Transfer Pumps | 12 | 8 | 6 | 4 | 30 |
| Common/Utilities | 16 | 12 | 8 | 4 | 40 |
| **Subtotal** | 96 | 68 | 54 | 28 | **246** |
| Safety I/O | 48 | 32 | - | - | 80 |

#### 2.2.2 Filler Production Area

| Controller | Tag | Platform | Description |
|------------|-----|----------|-------------|
| FP-PLC-01 | Filler Production Main | Allen-Bradley ControlLogix L85E | All 3 filling lines |
| FP-SAF-01 | Filler Production Safety | Allen-Bradley GuardLogix L73S | Safety interlocks for filling |
| FP-RIO-01 | Filling Line 01 Remote I/O | 1756-EN2T + I/O Modules | Washer-Filler-Caploader Line 01 |
| FP-RIO-02 | Filling Line 02 Remote I/O | 1756-EN2T + I/O Modules | Washer-Filler-Caploader Line 02 |
| FP-RIO-03 | Filling Line 03 Remote I/O | 1756-EN2T + I/O Modules | Washer-Filler-Caploader Line 03 |
| FP-VFD-xx | Variable Frequency Drives | PowerFlex 525/755 | Line speed control |

**I/O Estimate - Filler Production (per line):**

| Equipment | DI | DO | AI | AO | Total |
|-----------|----|----|----|----|-------|
| Washer | 24 | 16 | 8 | 4 | 52 |
| Filler | 32 | 24 | 12 | 8 | 76 |
| Caploader | 24 | 16 | 4 | 2 | 46 |
| Conveyors | 16 | 12 | 2 | 4 | 34 |
| **Per Line** | 96 | 68 | 26 | 18 | **208** |
| **3 Lines Total** | 288 | 204 | 78 | 54 | **624** |
| Safety I/O (3 lines) | 72 | 48 | - | - | 120 |

#### 2.2.3 Packaging Area

| Controller | Tag | Platform | Description |
|------------|-----|----------|-------------|
| PK-PLC-01 | Packaging Main | Allen-Bradley ControlLogix L85E | All 4 labeling/packaging lines |
| PK-SAF-01 | Packaging Safety | Allen-Bradley GuardLogix L73S | Safety interlocks for packaging |
| PK-RIO-01 to 04 | Labeler Lines 01-04 Remote I/O | 1756-EN2T + I/O Modules | Labeler-Packager-Sealer |

**I/O Estimate - Packaging (per line):**

| Equipment | DI | DO | AI | AO | Total |
|-----------|----|----|----|----|-------|
| Labeler | 24 | 16 | 4 | 2 | 46 |
| Packager | 20 | 14 | 2 | 2 | 38 |
| Sealer | 16 | 12 | 4 | 2 | 34 |
| Conveyors | 12 | 8 | 2 | 2 | 24 |
| **Per Line** | 72 | 50 | 12 | 8 | **142** |
| **4 Lines Total** | 288 | 200 | 48 | 32 | **568** |
| Safety I/O (4 lines) | 64 | 48 | - | - | 112 |

#### 2.2.4 Palletizing Area

| Controller | Tag | Platform | Description |
|------------|-----|----------|-------------|
| PZ-PLC-01 | Palletizing Main | Allen-Bradley ControlLogix L83E | Robotic palletizers and wrappers |
| PZ-SAF-01 | Palletizing Safety | Allen-Bradley GuardLogix L73S | Safety interlocks for palletizing |
| PZ-ROB-01 | Palletizer 01 Robot | Fanuc R-2000iC | Automated palletizer |
| PZ-ROB-02 | Palletizer 02 Robot | Fanuc R-2000iC | Automated palletizer |
| PZ-RIO-01 | Palletizing Remote I/O | 1756-EN2T + I/O Modules | Conveyors, wrappers, manual stations |

**I/O Estimate - Palletizing:**

| Equipment | DI | DO | AI | AO | Total |
|-----------|----|----|----|----|-------|
| Robotic Palletizer 01 | 24 | 16 | 4 | 2 | 46 |
| Robotic Palletizer 02 | 24 | 16 | 4 | 2 | 46 |
| Wrapper 01 | 16 | 12 | 2 | 2 | 32 |
| Wrapper 02 | 16 | 12 | 2 | 2 | 32 |
| Manual Stations (x4) | 32 | 24 | 0 | 0 | 56 |
| Pallet Conveyors | 24 | 16 | 4 | 4 | 48 |
| **Subtotal** | 136 | 96 | 16 | 12 | **260** |
| Safety I/O | 64 | 48 | - | - | 112 |

### 2.3 Total I/O Summary

| Area | Standard I/O | Safety I/O | Total |
|------|--------------|------------|-------|
| Liquid Processing | 246 | 80 | 326 |
| Filler Production | 624 | 120 | 744 |
| Packaging | 568 | 112 | 680 |
| Palletizing | 260 | 112 | 372 |
| **Plant Total** | **1,698** | **424** | **2,122** |

---

## 3. Control Narratives

### 3.1 Batch Mixing Sequence (Mix Room VAT-01 to VAT-04)

#### 3.1.1 Overview

The batch mixing sequence controls the preparation of beverage products in mixing vats VAT-01 through VAT-04. Each vat operates as an independent batch unit capable of executing recipe-driven mixing sequences per ISA-88 batch control standards.

#### 3.1.2 Equipment Module Definitions

**Mixing Vat (VAT-xx) Equipment Module:**
```
VAT-xx
  |-- Inlet Valve (XV-xx-01) - Ingredient A
  |-- Inlet Valve (XV-xx-02) - Ingredient B
  |-- Inlet Valve (XV-xx-03) - Water
  |-- Outlet Valve (XV-xx-04) - Transfer to Tank Storage
  |-- Drain Valve (XV-xx-05) - CIP Drain
  |-- Agitator Motor (AG-xx-01)
  |-- Jacket Heating/Cooling Valve (TV-xx-01)
  |-- Instrumentation:
      |-- Temperature (TT-xx-01)
      |-- Weight/Level (WT-xx-01)
      |-- Flow (FT-xx-01)
```

#### 3.1.3 Phase Definitions

**PHASE 01: PRE-BATCH CHECK**
```
STEP 1.0: Verify Equipment Ready
  - Confirm VAT-xx not in CIP mode
  - Confirm VAT-xx empty (WT-xx-01 < 50 kg)
  - Confirm all inlet valves CLOSED
  - Confirm outlet valve CLOSED
  - Confirm drain valve CLOSED
  - Confirm destination tank available (from recipe parameter)

STEP 1.1: Initialize Batch Record
  - Create batch record with Work Order number
  - Log batch start time
  - Record operator ID
  - Publish batch start to UNS topic:
    Enterprise B/Site1/liquidprocessing/mixroom01/vatXX/workorder/
```

**PHASE 02: INGREDIENT CHARGING**
```
STEP 2.0: Charge Ingredient A
  - Open inlet valve XV-xx-01
  - Monitor weight WT-xx-01
  - Target: Recipe.IngredientA_SP +/- Recipe.IngredientA_Tol
  - Close XV-xx-01 when target reached
  - Log actual weight to batch record

STEP 2.1: Charge Ingredient B
  - Open inlet valve XV-xx-02
  - Monitor weight WT-xx-01
  - Target: Recipe.IngredientB_SP +/- Recipe.IngredientB_Tol
  - Close XV-xx-02 when target reached
  - Log actual weight to batch record

STEP 2.2: Charge Water
  - Open inlet valve XV-xx-03
  - Monitor weight WT-xx-01
  - Target: Recipe.Water_SP +/- Recipe.Water_Tol
  - Close XV-xx-03 when target reached
  - Log actual weight and total batch weight
```

**PHASE 03: MIXING**
```
STEP 3.0: Start Agitator
  - Verify charging complete
  - Start agitator AG-xx-01 at Recipe.AgitatorSpeed_SP
  - Confirm agitator running (current feedback)

STEP 3.1: Temperature Control
  - Enable temperature control loop TIC-xx-01
  - Setpoint: Recipe.MixTemp_SP
  - Control jacket valve TV-xx-01
  - Wait for temperature within +/- Recipe.MixTemp_Tol

STEP 3.2: Mix Hold
  - Maintain temperature and agitation
  - Timer: Recipe.MixTime_SP
  - Log temperature profile every 30 seconds
  - Publish real-time data to UNS:
    Enterprise B/Site1/liquidprocessing/mixroom01/vatXX/processdata/process/
```

**PHASE 04: QUALITY CHECK**
```
STEP 4.0: Sample Point
  - Reduce agitator to sample speed
  - Illuminate sample ready indicator
  - HOLD for operator quality confirmation
  - Input: QC_Pass (BOOL) from HMI

STEP 4.1: QC Decision
  IF QC_Pass = TRUE:
    - Log QC approval and operator ID
    - Proceed to Transfer Phase
  IF QC_Pass = FALSE:
    - Log QC rejection
    - HOLD for disposition decision
    - Options: Rework, Dump, Re-sample
```

**PHASE 05: TRANSFER TO STORAGE**
```
STEP 5.0: Prepare Transfer
  - Confirm destination tank TK-xx available
  - Confirm destination tank has capacity
  - Request transfer path from routing logic

STEP 5.1: Execute Transfer
  - Open VAT outlet valve XV-xx-04
  - Start transfer pump P-xx-01
  - Monitor VAT level decreasing
  - Monitor destination tank level increasing

STEP 5.2: Complete Transfer
  - When VAT weight < 25 kg (heel):
    - Stop transfer pump
    - Close outlet valve
    - Log transfer complete
    - Release VAT for next batch or CIP
```

**PHASE 06: BATCH COMPLETE**
```
STEP 6.0: Finalize Records
  - Calculate batch totals
  - Generate batch report
  - Update lot tracking in MES
  - Publish batch complete to UNS:
    Enterprise B/Site1/liquidprocessing/mixroom01/vatXX/workorder/status = "COMPLETE"
```

#### 3.1.4 State Machine

```
         +------------+
         |   IDLE     |<------------------+
         +-----+------+                   |
               |                          |
         [Start Batch]                    |
               |                          |
         +-----v------+                   |
         | PRE-CHECK  |                   |
         +-----+------+                   |
               |                          |
         [Checks Pass]                    |
               |                          |
         +-----v------+                   |
         |  CHARGING  |                   |
         +-----+------+                   |
               |                          |
         [Charge Complete]                |
               |                          |
         +-----v------+                   |
         |   MIXING   |                   |
         +-----+------+                   |
               |                          |
         [Mix Complete]                   |
               |                          |
         +-----v------+                   |
         |  QC HOLD   |                   |
         +-----+------+                   |
               |                          |
         [QC Approved]                    |
               |                          |
         +-----v------+                   |
         | TRANSFER   |                   |
         +-----+------+                   |
               |                          |
         [Transfer Complete]              |
               |                          |
         +-----v------+                   |
         |  COMPLETE  +-------------------+
         +------------+

    Any State --> HOLD (Operator Hold)
    Any State --> ABORT (Critical Fault)
    HOLD --> Previous State (Resume)
```

---

### 3.2 Tank Transfer Operations

#### 3.2.1 Overview

Tank storage (TK-01 through TK-06) provides intermediate storage between batch mixing and filling operations. Transfer operations move product between mix room, storage tanks, and filling lines.

#### 3.2.2 Equipment Module Definitions

**Storage Tank (TK-xx) Equipment Module:**
```
TK-xx
  |-- Inlet Valve (XV-xx-10) - From Mix Room
  |-- Inlet Valve (XV-xx-11) - From Other Tanks
  |-- Outlet Valve (XV-xx-12) - To Filling Lines
  |-- Outlet Valve (XV-xx-13) - To Other Tanks
  |-- Drain Valve (XV-xx-14) - CIP Drain
  |-- Vent Valve (XV-xx-15)
  |-- Instrumentation:
      |-- Level/Weight (WT-xx-01)
      |-- Temperature (TT-xx-01)
      |-- Flow (FT-xx-01)
```

#### 3.2.3 Transfer Control Narrative

**TRANSFER TYPE 1: Mix Room to Storage Tank**
```
PRECONDITIONS:
  - Source VAT contains approved batch (QC_Pass = TRUE)
  - Destination TK-xx has sufficient capacity
  - Transfer path clear (no other transfer using same piping)
  - Destination tank product code matches or tank is empty

SEQUENCE:
  1. Verify preconditions met
  2. Open destination tank inlet valve XV-xx-10
  3. Open source vat outlet valve
  4. Start transfer pump P-TR-xx
  5. Monitor:
     - Source level decreasing
     - Destination level increasing
     - Flow rate within limits
  6. When source level < LOW threshold:
     - Stop pump
     - Close all valves
     - Update inventory (lot tracking)
     - Release transfer path
```

**TRANSFER TYPE 2: Storage Tank to Filling Line**
```
PRECONDITIONS:
  - Source TK-xx contains product matching Work Order
  - Filling line in Ready state (FILL_LINE_READY = TRUE)
  - Bowl level calling for product (BOWL_LEVEL_LOW = TRUE)
  - Transfer path clear

SEQUENCE:
  1. Verify preconditions met
  2. Open tank outlet valve XV-xx-12
  3. Open filling line inlet valve
  4. Start supply pump P-SUP-xx
  5. Modulate flow control valve FCV-xx to maintain:
     - Bowl level setpoint
     - Maximum flow rate limit
  6. Continue until:
     - Filling line stops calling for product
     - Tank reaches LOW level
     - Work order complete
  7. Close valves in reverse order
  8. Update consumption records
```

**TRANSFER TYPE 3: Tank to Tank**
```
PRECONDITIONS:
  - Both tanks contain same product lot (or dest empty)
  - Destination has capacity
  - Transfer authorized by production

SEQUENCE:
  1. Open destination inlet valve
  2. Open source outlet valve
  3. Start transfer pump
  4. Monitor levels until complete
  5. Update lot tracking (lot combination record)
```

#### 3.2.4 Routing Logic

```
TRANSFER ROUTING MATRIX:
+--------+-------+-------+-------+-------+-------+-------+------+------+------+
| SOURCE | TK-01 | TK-02 | TK-03 | TK-04 | TK-05 | TK-06 | FL01 | FL02 | FL03 |
+--------+-------+-------+-------+-------+-------+-------+------+------+------+
| VAT-01 |   X   |   X   |   X   |       |       |       |      |      |      |
| VAT-02 |   X   |   X   |   X   |       |       |       |      |      |      |
| VAT-03 |       |       |       |   X   |   X   |   X   |      |      |      |
| VAT-04 |       |       |       |   X   |   X   |   X   |      |      |      |
| TK-01  |   -   |   X   |       |       |       |       |  X   |  X   |      |
| TK-02  |   X   |   -   |       |       |       |       |  X   |  X   |      |
| TK-03  |       |       |   -   |       |       |       |  X   |  X   |  X   |
| TK-04  |       |       |       |   -   |   X   |       |      |      |  X   |
| TK-05  |       |       |       |   X   |   -   |   X   |      |  X   |  X   |
| TK-06  |       |       |       |       |   X   |   -   |      |  X   |  X   |
+--------+-------+-------+-------+-------+-------+-------+------+------+------+
X = Transfer path available
```

---

### 3.3 Filling Line Startup/Shutdown Sequences

#### 3.3.1 Overview

Each filling line (01, 02, 03) consists of three synchronized machines:
- **Washer:** Cleans and sanitizes containers
- **Filler:** Fills containers with product
- **Caploader:** Applies and secures caps

#### 3.3.2 Equipment Configuration

```
FILLING LINE TOPOLOGY:

  [Container]     [WASHER]      [FILLER]     [CAPLOADER]    [Filled]
   Infeed   ---->  Rinse   ---->  Fill   ---->   Cap    ---->  Outfeed
     |              |              |              |              |
     v              v              v              v              v
  CNT_INFEED    WSH_OUTFEED   FIL_OUTFEED   CAP_OUTFEED    CNT_OUTFEED
```

**Key Tags Per Filling Line:**
```
Enterprise B/Site1/fillerproduction/fillinglineXX/
  |-- washer/
  |   |-- processdata/state/code
  |   |-- processdata/state/name
  |   |-- metric/input/countinfeed
  |   |-- metric/input/countoutfeed
  |-- filler/
  |   |-- processdata/state/code
  |   |-- processdata/count/infeed
  |   |-- processdata/count/outfeed
  |   |-- processdata/count/defect
  |   |-- processdata/rate/instant
  |-- caploader/
  |   |-- processdata/state/code
  |   |-- metric/input/countinfeed
  |   |-- metric/input/countoutfeed
  |-- metric/
  |   |-- oee
  |   |-- availability
  |   |-- performance
  |   |-- quality
  |-- workorder/
```

#### 3.3.3 Startup Sequence

```
FILLING LINE STARTUP SEQUENCE - FILLINGLINE-XX

PHASE S1: PRE-START VERIFICATION (Duration: ~2 minutes)
===========================================================
STEP S1.1: Safety System Check
  - Verify all E-Stops reset (E_STOP_OK = TRUE)
  - Verify light curtains clear (LC_OK = TRUE)
  - Verify guard doors closed (GUARDS_OK = TRUE)
  - Verify safety PLC healthy (SAFETY_PLC_OK = TRUE)

STEP S1.2: Equipment Status Check
  - Washer: Check chemical levels, water supply, drain clear
  - Filler: Check product supply available, bowl level adequate
  - Caploader: Check cap hopper level > MIN
  - All VFDs: Verify ready status, no faults

STEP S1.3: Recipe/Work Order Verification
  - Work order downloaded from MES
  - Recipe parameters loaded:
    - Fill volume setpoint
    - Line speed target
    - Container type
    - Cap type
  - Verify recipe matches product in supply tank

STEP S1.4: Operator Confirmation
  - Display startup checklist on HMI
  - Require operator acknowledgment
  - Log operator ID for batch record

PHASE S2: MACHINE INITIALIZATION (Duration: ~3 minutes)
===========================================================
STEP S2.1: Enable Utilities
  - Enable compressed air supply
  - Enable rinse water supply
  - Enable product supply pump (standby)

STEP S2.2: Initialize Washer
  - Start washer recirculation pump
  - Verify chemical dosing system ready
  - Enable washer indexing (no containers)
  - Verify spray nozzles operating
  - State: WASHER_READY

STEP S2.3: Initialize Filler
  - Open product supply valve
  - Fill product bowl to operating level
  - Verify bowl level transmitter reading
  - Prime fill valves (if required)
  - State: FILLER_READY

STEP S2.4: Initialize Caploader
  - Verify cap hopper level
  - Enable cap feeder vibration
  - Verify cap orientation sensors
  - State: CAPLOADER_READY

PHASE S3: LINE STARTUP (Duration: ~2 minutes)
===========================================================
STEP S3.1: Start Conveyors
  - Start outfeed conveyor (downstream first)
  - Start caploader outfeed conveyor
  - Start filler outfeed conveyor
  - Start washer outfeed conveyor
  - Start infeed conveyor (upstream last)
  - All conveyors at STARTUP_SPEED (60% of nominal)

STEP S3.2: Synchronized Machine Start
  - START sequence: Caploader -> Filler -> Washer
  - Caploader: Enable capping cycle
  - Filler: Enable filling cycle (no-container inhibit active)
  - Washer: Enable wash cycle

STEP S3.3: Release Containers
  - Open infeed gate
  - Allow containers to enter washer
  - Monitor first container through system
  - Count infeed vs outfeed for tracking

PHASE S4: RAMP TO PRODUCTION (Duration: ~5 minutes)
===========================================================
STEP S4.1: Speed Ramp
  - Gradually increase line speed from 60% to TARGET
  - Ramp rate: 5% per minute
  - Monitor all machine synchronization

STEP S4.2: Verify Synchronization
  - Monitor accumulation zones
  - Verify no conveyor backup
  - Verify no starving downstream
  - Adjust individual machine speeds as needed

STEP S4.3: Production Mode Active
  - State: LINE_RUNNING
  - Enable production counters
  - Enable OEE calculations
  - Publish to UNS: state/name = "RUNNING"
```

#### 3.3.4 Shutdown Sequence

```
FILLING LINE SHUTDOWN SEQUENCE - FILLINGLINE-XX

PHASE D1: PRODUCTION STOP (Duration: ~5 minutes)
===========================================================
STEP D1.1: Close Infeed
  - Close container infeed gate
  - Allow line to empty (no new containers)
  - Continue running until all containers exit

STEP D1.2: Drain Product Line
  - Close product supply valve when bowl LOW
  - Allow remaining product to fill last containers
  - State: DRAINING

STEP D1.3: Last Container Out
  - Track last container through each machine
  - When caploader outfeed count stable for 30 sec:
    - Record final production counts
    - State: DRAINED

PHASE D2: MACHINE STOP (Duration: ~2 minutes)
===========================================================
STEP D2.1: Stop Machines (Reverse Order)
  - Stop washer cycle
  - Stop filler cycle
  - Stop caploader cycle

STEP D2.2: Stop Conveyors
  - Stop infeed conveyor first
  - Stop middle conveyors
  - Stop outfeed conveyor last

STEP D2.3: Disable Utilities
  - Close product supply valves
  - Maintain air pressure (for safety)
  - Washer to recirculation mode

PHASE D3: SECURING (Duration: ~1 minute)
===========================================================
STEP D3.1: Final Status
  - Record shift production totals
  - Record downtime minutes
  - Calculate final OEE

STEP D3.2: Secure State
  - State: LINE_STOPPED
  - Publish to UNS: state/name = "STOPPED"
  - Ready for CIP or next production run
```

#### 3.3.5 Line Speed Synchronization

```
LINE SYNCHRONIZATION CONTROL

MASTER/SLAVE ARCHITECTURE:
  - MASTER: Filler (sets line pace)
  - SLAVE 1: Washer (follows filler demand)
  - SLAVE 2: Caploader (follows filler output)

SPEED CONTROL STRATEGY:
  Washer_Speed = Filler_Speed * 1.05  (5% overspeed for accumulation)
  Caploader_Speed = Filler_Speed * 1.00 (matched to filler)

ACCUMULATION ZONES:
  Zone 1 (Washer to Filler):
    - Photoeye PE-XX-01 monitors queue
    - IF queue < MIN: Slow washer 10%
    - IF queue > MAX: Speed washer 10%

  Zone 2 (Filler to Caploader):
    - Photoeye PE-XX-02 monitors queue
    - IF queue < MIN: Slow filler 5%
    - IF queue > MAX: Speed caploader 5%

REJECT HANDLING:
  - Defect detected at filler inspection
  - Diverter activated at reject station
  - Reject counter incremented
  - No line speed adjustment for normal reject rates
  - IF reject_rate > 5%: Reduce line speed, alert operator
```

---

### 3.4 Packaging Line Control

#### 3.4.1 Overview

Four parallel packaging lines (Labelerline01-04) process filled containers from the filling area:
- **Labeler:** Applies product labels
- **Packager:** Groups containers into cases
- **Sealer:** Seals cases

#### 3.4.2 Line Coordination

```
PACKAGING LINE TOPOLOGY:

  [From Filler]   [LABELER]    [PACKAGER]    [SEALER]     [To Palletizing]
     Infeed   ---->  Label  ---->  Pack   ---->  Seal  ---->   Outfeed
       |             |             |             |               |
       v             v             v             v               v
    LAB_INFEED   LAB_OUTFEED  PKG_OUTFEED  SEL_OUTFEED     PALLET_INFEED
```

#### 3.4.3 Label Verification Control

```
LABEL VERIFICATION SEQUENCE

STEP 1: Label Application
  - Apply label to container
  - Increment label_applied counter

STEP 2: Vision Inspection
  - Camera captures label image
  - Vision system verifies:
    - Label presence
    - Label orientation
    - Barcode readability
    - Date code legibility

STEP 3: Decision
  IF verification PASS:
    - Increment good_count
    - Allow to packager
  IF verification FAIL:
    - Increment defect_count
    - Activate reject diverter
    - Log defect code (missing, misaligned, unreadable)

STEP 4: Statistical Monitoring
  - Track defect rate over 100-container window
  - IF defect_rate > 3%: Generate alarm
  - IF defect_rate > 5%: Stop line for adjustment
```

---

### 3.5 Palletizing Control

#### 3.5.1 Robotic Palletizer Sequence

```
ROBOTIC PALLETIZER SEQUENCE - PALLETIZER-XX

STATE: IDLE
  - Robot at home position
  - Pallet positions empty or assigned
  - Waiting for case arrival

STATE: PICKING
  - Case detected at pickup position
  - Robot moves to pickup position
  - Gripper closes on case
  - Verify grip sensor
  - Robot lifts case

STATE: PLACING
  - Robot moves to calculated place position
  - Position based on:
    - Layer number (1-5)
    - Position in layer (pattern)
    - Pallet assignment (01 or 02)
  - Robot places case
  - Gripper opens
  - Robot retracts

STATE: LAYER_COMPLETE
  - When layer count reached:
    - Insert slip sheet (if configured)
    - Increment layer count
    - IF final layer: -> PALLET_COMPLETE
    - ELSE: -> Continue picking

STATE: PALLET_COMPLETE
  - Full pallet built
  - Signal wrapper ready
  - Switch to alternate pallet position
  - Release full pallet to wrapper
  - Request new empty pallet

WRAPPER SEQUENCE:
  1. Pallet enters wrapper
  2. Film carriage homes
  3. Apply film to pallet base
  4. Rotate pallet (or carriage rotates)
  5. Apply wraps per recipe (typically 3 bottom, 2 middle, 3 top)
  6. Cut film
  7. Release pallet to outfeed
```

---

## 4. Interlocks and Permissives

### 4.1 Interlock Philosophy

**INTERLOCK CATEGORIES:**
- **Category A (Safety):** Personnel protection - hardwired and SIL-rated
- **Category B (Equipment):** Equipment protection - PLC logic with redundancy
- **Category C (Process):** Process protection - PLC logic standard

### 4.2 Liquid Processing Interlocks

#### 4.2.1 Mixing Vat Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-VAT-001 | A | Agitator guard open | Stop agitator immediately | Auto when guard closed |
| IL-VAT-002 | B | High-high level (>95%) | Close all inlet valves | Manual reset after level <90% |
| IL-VAT-003 | B | Low-low level (<5%) | Stop agitator, close outlet | Auto when level >10% |
| IL-VAT-004 | B | High temperature (>90C) | Close heating valve, open cooling | Auto when temp <85C |
| IL-VAT-005 | C | Outlet valve open | Inhibit inlet valves | Auto when outlet closed |
| IL-VAT-006 | C | CIP mode active | Inhibit all production operations | Manual reset after CIP complete |

#### 4.2.2 Tank Storage Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-TK-001 | B | High-high level (>95%) | Close all inlet valves, stop pumps | Manual reset |
| IL-TK-002 | B | Low-low level (<3%) | Close outlet valve, stop supply pump | Auto when level >5% |
| IL-TK-003 | C | Vent valve closed during fill | Inhibit filling | Auto when vent open |
| IL-TK-004 | C | Product mismatch | Block transfer to tank | Manual override with authorization |

#### 4.2.3 Transfer System Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-TR-001 | B | Pump dry run (no flow >30 sec) | Stop pump | Manual reset |
| IL-TR-002 | B | Pump high current | Stop pump | Manual reset |
| IL-TR-003 | C | Path conflict | Block second transfer request | Auto when path clear |
| IL-TR-004 | C | Destination full | Stop transfer | Auto when capacity available |

### 4.3 Filler Production Interlocks

#### 4.3.1 Washer Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-WSH-001 | A | Access door open | Stop all motion | Auto when door closed + reset |
| IL-WSH-002 | B | Chemical tank empty | Stop chemical dosing, alarm | Auto when refilled |
| IL-WSH-003 | B | Water supply pressure low | Stop washer cycle | Auto when pressure restored |
| IL-WSH-004 | C | Drain blocked | Stop washer, alarm | Manual reset after cleared |

#### 4.3.2 Filler Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-FIL-001 | A | Light curtain interrupted | Stop filler, E-stop filling heads | Manual reset |
| IL-FIL-002 | A | Guard door open | Inhibit start, stop if running | Auto when closed + reset |
| IL-FIL-003 | B | Bowl level low-low | Stop filler cycle | Auto when level >25% |
| IL-FIL-004 | B | Bowl level high-high | Close supply valve | Auto when level <90% |
| IL-FIL-005 | B | No container present | Inhibit fill valve open | Auto (per fill head) |
| IL-FIL-006 | C | High reject rate (>5%) | Reduce speed, alarm | Manual reset |

#### 4.3.3 Caploader Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-CAP-001 | A | Hopper access open | Stop cap feeder | Auto when closed |
| IL-CAP-002 | B | Hopper level low | Alarm, request refill | Auto when refilled |
| IL-CAP-003 | B | Hopper level empty | Stop capping cycle | Auto when level >MIN |
| IL-CAP-004 | C | Cap orientation fault | Reject cap, retry | Auto |
| IL-CAP-005 | C | Torque out of limits | Reject container, alarm | Auto |

### 4.4 Packaging Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-LAB-001 | B | Label roll empty | Stop labeler, alarm | Auto when new roll loaded |
| IL-LAB-002 | C | Vision system fault | Stop line, alarm | Manual reset |
| IL-PKG-001 | A | Guard open | Stop packager | Auto when closed + reset |
| IL-PKG-002 | B | Case magazine empty | Stop packager, alarm | Auto when refilled |
| IL-SEL-001 | B | Glue system fault | Stop sealer | Manual reset |
| IL-SEL-002 | C | Tape empty | Stop sealer, alarm | Auto when reloaded |

### 4.5 Palletizing Interlocks

| Interlock ID | Category | Condition | Action | Reset |
|--------------|----------|-----------|--------|-------|
| IL-PAL-001 | A | Robot cell guard open | E-stop robot | Manual reset |
| IL-PAL-002 | A | Light curtain (pallet exit) | Pause robot | Auto when clear |
| IL-PAL-003 | B | Robot fault | Stop palletizer cell | Manual reset |
| IL-PAL-004 | B | Gripper pressure low | Stop picking | Auto when restored |
| IL-WRP-001 | A | Wrapper guard open | Stop wrapper | Auto when closed + reset |
| IL-WRP-002 | B | Film empty | Stop wrapper | Auto when reloaded |
| IL-WRP-003 | C | Pallet position fault | Stop wrapper, alarm | Manual reset |

### 4.6 Permissive Matrix

#### 4.6.1 Startup Permissives

| Equipment | Permissives Required | Override Level |
|-----------|---------------------|----------------|
| Mixing Vat Agitator | Guard closed, Level >10%, Not in CIP | Maintenance |
| Transfer Pump | Source level >MIN, Dest level <MAX, Path clear | Supervisor |
| Washer | Safety OK, Utilities OK, Chemicals OK | None |
| Filler | Safety OK, Bowl level OK, Washer running | None |
| Caploader | Safety OK, Hopper level OK, Filler running | None |
| Labeler | Safety OK, Labels loaded, Vision OK | None |
| Packager | Safety OK, Cases available, Labeler running | None |
| Robot Palletizer | Safety OK, Pallets available, Robot enabled | None |

---

## 5. Communication Networks

### 5.1 Network Architecture Overview

```
+------------------------------------------------------------------------+
|                         ENTERPRISE B - SITE 1                           |
|                      NETWORK ARCHITECTURE DIAGRAM                       |
+------------------------------------------------------------------------+

                            [CORPORATE NETWORK]
                                   |
                            [FIREWALL/DMZ]
                                   |
                        +----------+----------+
                        |                     |
                   [MQTT BROKER]         [HISTORIAN]
                   (UNS Backbone)        (QuestDB)
                        |                     |
            +-----------+-----------+---------+
            |                       |
    [Neo4j Graph DB]          [MES Server]
            |                       |
+-----------|----------------------|----------------------------------------+
|           |      LEVEL 3         |                                        |
|    +------+------+        +------+------+                                 |
|    | SCADA       |        | Batch       |                                 |
|    | Server 01   |        | Server      |                                 |
|    +------+------+        +------+------+                                 |
|           |                      |                                        |
+-----------+----------------------+----------------------------------------+
            |                      |
            |   PLANT NETWORK BACKBONE (1Gbps Managed)
            |   Protocol: EtherNet/IP
            |
+-----------|----------------------------------------------------------+
|           |                    LEVEL 2                                |
|     +-----+------+                                                    |
|     | PLANT      |                                                    |
|     | SWITCH     |                                                    |
|     | (Layer 3)  |                                                    |
|     +-----+------+                                                    |
|           |                                                           |
|   +-------+--------+--------+--------+                                |
|   |       |        |        |        |                                |
+---|-------|--------|--------|--------|--------------------------------+
    |       |        |        |        |
+---+---+  +---+---+ +---+---+ +---+---+
|LP VLAN|  |FP VLAN| |PK VLAN| |PZ VLAN|
| .10.x |  | .20.x | | .30.x | | .40.x |
+---+---+  +---+---+ +---+---+ +---+---+
    |          |         |         |
+---+---+  +---+---+ +---+---+ +---+---+
|LP-PLC |  |FP-PLC | |PK-PLC | |PZ-PLC |
|LP-SAF |  |FP-SAF | |PK-SAF | |PZ-SAF |
|LP-RIO |  |FP-RIO | |PK-RIO | |PZ-ROB |
|       |  |FP-VFD | |       | |       |
+-------+  +-------+ +-------+ +-------+
```

### 5.2 Network Specifications

#### 5.2.1 Physical Layer

| Layer | Media | Speed | Redundancy |
|-------|-------|-------|------------|
| Plant Backbone | CAT6A / Fiber | 1 Gbps | Ring Topology |
| Area Networks | CAT6A | 1 Gbps | Star from Area Switch |
| Device Level | CAT5E/CAT6 | 100 Mbps | Single path |
| Safety Network | CAT6A | 100 Mbps | CIP Safety Ring |

#### 5.2.2 IP Addressing Scheme

```
SITE 1 IP SCHEME: 10.1.xxx.yyy

Network Segments:
  10.1.0.x    - Plant backbone / servers
  10.1.10.x   - Liquid Processing area
  10.1.20.x   - Filler Production area
  10.1.30.x   - Packaging area
  10.1.40.x   - Palletizing area
  10.1.50.x   - HMI / Operator stations
  10.1.90.x   - Engineering / Programming
  10.1.100.x  - Safety network segment
```

#### 5.2.3 Device IP Assignments

**Liquid Processing (10.1.10.x):**
| Device | IP Address | Description |
|--------|------------|-------------|
| LP-PLC-01 | 10.1.10.1 | Main PLC |
| LP-SAF-01 | 10.1.10.2 | Safety PLC |
| LP-RIO-01 | 10.1.10.11 | Mix Room Remote I/O |
| LP-RIO-02 | 10.1.10.12 | Tank Storage Remote I/O |
| LP-HMI-01 | 10.1.10.101 | Mix Room HMI |
| LP-HMI-02 | 10.1.10.102 | Tank Storage HMI |

**Filler Production (10.1.20.x):**
| Device | IP Address | Description |
|--------|------------|-------------|
| FP-PLC-01 | 10.1.20.1 | Main PLC |
| FP-SAF-01 | 10.1.20.2 | Safety PLC |
| FP-RIO-01 | 10.1.20.11 | Line 01 Remote I/O |
| FP-RIO-02 | 10.1.20.12 | Line 02 Remote I/O |
| FP-RIO-03 | 10.1.20.13 | Line 03 Remote I/O |
| FP-VFD-01 | 10.1.20.21 | Line 01 VFDs |
| FP-VFD-02 | 10.1.20.22 | Line 02 VFDs |
| FP-VFD-03 | 10.1.20.23 | Line 03 VFDs |
| FP-HMI-01 | 10.1.20.101 | Line 01 HMI |
| FP-HMI-02 | 10.1.20.102 | Line 02 HMI |
| FP-HMI-03 | 10.1.20.103 | Line 03 HMI |

### 5.3 Protocol Specifications

#### 5.3.1 EtherNet/IP (Primary Control Network)

**Usage:**
- PLC to PLC communication
- PLC to Remote I/O
- PLC to VFD/Drives
- HMI to PLC

**Configuration:**
- Producer/Consumer model for PLC intercommunication
- Cyclic I/O for remote I/O (RPI = 10ms)
- Explicit messaging for configuration and diagnostics

#### 5.3.2 CIP Safety over EtherNet/IP

**Usage:**
- Safety PLC to safety I/O modules
- Safety PLC to safety PLC (cross-area safety signals)

**Configuration:**
- Safety RPI = 20ms
- SIL 3 / PL e capable
- Ring topology with DLR (Device Level Ring)

#### 5.3.3 Modbus TCP (Secondary Protocol)

**Usage:**
- Third-party instrumentation (temperature controllers, analyzers)
- Energy meters
- Legacy equipment integration

**Configuration:**
- Port 502
- Polling rate: 1 second typical
- Implemented via Modbus/TCP to EtherNet/IP gateway

#### 5.3.4 MQTT (UNS Integration)

**Usage:**
- Real-time data to Unified Namespace
- MES integration
- Historian data collection

**Configuration:**
```
Broker: mqtt.enterpriseb.local:1883
QoS: 1 (At least once delivery)
Keepalive: 60 seconds
Topic Structure: Enterprise B/Site1/{area}/{unit}/{equipment}/{datatype}/{tag}
```

**Publishing Devices:**
- Ignition Edge gateways at each area (one per PLC)
- Publish rate: 1 second for process values, on-change for states

### 5.4 Network Security

#### 5.4.1 Segmentation

```
VLAN SEGMENTATION:
  VLAN 10: Liquid Processing Control
  VLAN 20: Filler Production Control
  VLAN 30: Packaging Control
  VLAN 40: Palletizing Control
  VLAN 50: HMI/Operator Network
  VLAN 90: Engineering Access
  VLAN 100: Safety Network (Isolated)
  VLAN 200: MQTT/UNS Bridge
```

#### 5.4.2 Firewall Rules

| Source | Destination | Ports | Action |
|--------|-------------|-------|--------|
| Corporate | Control VLANs | ALL | DENY |
| SCADA Server | Control VLANs | 44818, 2222 | ALLOW |
| Engineering (VLAN 90) | Control VLANs | 44818, 2222 | ALLOW |
| MQTT Gateway | MQTT Broker | 1883, 8883 | ALLOW |
| Control VLANs | Safety VLAN | ALL | DENY (except designated) |

---

## 6. Operator Interface Requirements

### 6.1 HMI System Overview

| Location | Tag | Platform | Display Size |
|----------|-----|----------|--------------|
| Mix Room | LP-HMI-01 | FactoryTalk View SE | 22" Touchscreen |
| Tank Farm | LP-HMI-02 | FactoryTalk View SE | 22" Touchscreen |
| Fill Line 01 | FP-HMI-01 | FactoryTalk View SE | 22" Touchscreen |
| Fill Line 02 | FP-HMI-02 | FactoryTalk View SE | 22" Touchscreen |
| Fill Line 03 | FP-HMI-03 | FactoryTalk View SE | 22" Touchscreen |
| Pack Line 01-02 | PK-HMI-01 | FactoryTalk View SE | 22" Touchscreen |
| Pack Line 03-04 | PK-HMI-02 | FactoryTalk View SE | 22" Touchscreen |
| Palletizing | PZ-HMI-01 | FactoryTalk View SE | 22" Touchscreen |
| Control Room | CR-WS-01/02 | FactoryTalk View SE | Dual 27" Monitors |

### 6.2 Screen Hierarchy

```
LEVEL 0: PLANT OVERVIEW
  |
  +-- LEVEL 1: AREA OVERVIEW
  |     |-- Liquid Processing Overview
  |     |-- Filler Production Overview
  |     |-- Packaging Overview
  |     |-- Palletizing Overview
  |     |-- Plant Metrics Dashboard
  |
  +-- LEVEL 2: UNIT DETAIL
  |     |-- Mix Room (VAT-01 to VAT-04)
  |     |-- Tank Storage (TK-01 to TK-06)
  |     |-- Filling Line 01/02/03
  |     |-- Labeler Line 01/02/03/04
  |     |-- Palletizer 01/02
  |
  +-- LEVEL 3: EQUIPMENT DETAIL
  |     |-- Individual Vat Control
  |     |-- Individual Tank Control
  |     |-- Washer/Filler/Caploader Detail
  |     |-- Labeler/Packager/Sealer Detail
  |     |-- Robot Status/Wrapper Control
  |
  +-- LEVEL 4: DIAGNOSTICS
        |-- Alarm Summary
        |-- Trend Displays
        |-- Diagnostic Screens
        |-- Maintenance Screens
```

### 6.3 Screen Requirements by Area

#### 6.3.1 Liquid Processing Screens

**LP-001: Mix Room Overview**
- Display all 4 vats with status indication (color-coded)
- Show current batch state for each vat
- Display key parameters: level, temperature, agitator status
- Navigation buttons to individual vat screens
- Active alarms for mix room area

**LP-002: Vat Detail (VAT-01 to VAT-04)**
- P&ID representation of vat and associated equipment
- Real-time display: Level, Temperature, Flow, Weight
- Batch phase display with step detail
- Recipe parameter display
- Manual valve controls (with interlock status)
- Trend window (4-hour rolling)
- Work order and lot information

**LP-003: Tank Storage Overview**
- Display all 6 tanks with fill level bars
- Product/lot identification per tank
- Temperature indication
- Transfer status indicators
- Navigation to individual tank screens

**LP-004: Tank Detail (TK-01 to TK-06)**
- Tank P&ID with valve positions
- Level, temperature, flow displays
- Product/lot/expiry information
- Transfer history (last 10)
- Cleaning status (last CIP)

**LP-005: Transfer Control**
- Transfer matrix display
- Active transfer status
- Source/destination selection
- Transfer rate control
- Path availability status

#### 6.3.2 Filler Production Screens

**FP-001: Filler Production Overview**
- Three-line status display
- Per-line: State, Speed, Counts, OEE
- Active alarms for filler area
- Shift production totals

**FP-002: Filling Line Detail (x3)**
- Line P&ID schematic
- Machine status: Washer, Filler, Caploader
- Speed setpoint and actual
- Production counters: Good, Reject, Total
- Line OEE display (Availability, Performance, Quality)
- Work order information
- Active alarms for line

**FP-003: Washer Detail**
- Washer P&ID with sensor locations
- Chemical levels and dosing status
- Water/rinse parameters
- Maintenance counters (cycles, runtime)
- Fault history

**FP-004: Filler Detail**
- Filler P&ID with fill heads
- Bowl level and temperature
- Fill weight/volume displays
- Per-head status (if applicable)
- Reject analysis display

**FP-005: Caploader Detail**
- Caploader P&ID
- Hopper level
- Torque monitoring display
- Cap reject analysis
- Maintenance counters

#### 6.3.3 Packaging Screens

**PK-001: Packaging Overview**
- Four-line status display
- Per-line: State, Speed, Counts
- Active alarms

**PK-002: Labeler Line Detail (x4)**
- Line schematic with machine status
- Label verification results
- Case counts
- Quality statistics

**PK-003: Equipment Detail**
- Labeler, Packager, Sealer individual screens
- Maintenance parameters
- Fault diagnostics

#### 6.3.4 Palletizing Screens

**PZ-001: Palletizing Overview**
- Robot status (01 and 02)
- Manual station status (01-04)
- Pallet counts
- Wrapper status

**PZ-002: Robot Palletizer Detail**
- Robot position visualization
- Current pattern/layer
- Pallet status at each position
- Cycle time display
- Fault/alarm status

**PZ-003: Wrapper Detail**
- Wrapper status
- Film consumption
- Cycle counts
- Maintenance parameters

### 6.4 Standard Screen Elements

**Navigation Bar (All Screens):**
- Home button
- Area buttons (LP, FP, PK, PZ)
- Alarm summary button
- Trend button
- Login/logout
- Date/time display

**Status Footer (All Screens):**
- System status indicators
- Communication status
- Active user
- Alarm count by priority

**Color Standards:**
| State | Color | RGB |
|-------|-------|-----|
| Running/Normal | Green | 0, 255, 0 |
| Stopped | Gray | 128, 128, 128 |
| Fault/Alarm | Red | 255, 0, 0 |
| Warning | Yellow | 255, 255, 0 |
| Manual | Blue | 0, 0, 255 |
| Maintenance | Orange | 255, 165, 0 |

### 6.5 User Access Levels

| Level | Role | Capabilities |
|-------|------|--------------|
| 0 | View Only | View screens, acknowledge alarms |
| 1 | Operator | Level 0 + Start/Stop, Setpoint changes (within limits) |
| 2 | Lead Operator | Level 1 + Recipe selection, Transfer initiation |
| 3 | Supervisor | Level 2 + Override non-safety interlocks, Reset faults |
| 4 | Maintenance | Level 3 + Calibration, Maintenance modes |
| 5 | Engineering | Level 4 + Parameter changes, Screen modifications |
| 6 | Administrator | Full access, User management |

---

## 7. Alarm Philosophy

### 7.1 Alarm Philosophy Overview

This alarm philosophy follows ISA-18.2 (Management of Alarm Systems) principles to ensure alarms are:
- **Relevant:** Indicates a condition requiring operator action
- **Unique:** Not duplicated or redundant
- **Timely:** Allows adequate time for response
- **Prioritized:** Reflects urgency and consequence
- **Understandable:** Clear message describing condition and action

### 7.2 Alarm Priority Definitions

| Priority | Color | Sound | Response Time | Description |
|----------|-------|-------|---------------|-------------|
| 1 - Critical | Red + Flash | Continuous | Immediate (<1 min) | Safety risk, major equipment damage, major quality impact |
| 2 - High | Red | Fast beep | <5 minutes | Equipment damage possible, significant production impact |
| 3 - Medium | Yellow | Slow beep | <15 minutes | Abnormal operation, requires attention |
| 4 - Low | Cyan | Single beep | <60 minutes | Status change, advisory |
| Journal | White | None | N/A | Logged event, no action required |

### 7.3 Alarm Categorization

#### 7.3.1 Safety Alarms (Priority 1)

| Tag | Description | Setpoint | Action Required |
|-----|-------------|----------|-----------------|
| ALM_ESTOP_LP | E-Stop Liquid Processing | Activated | Investigate, reset when safe |
| ALM_ESTOP_FP | E-Stop Filler Production | Activated | Investigate, reset when safe |
| ALM_ESTOP_PK | E-Stop Packaging | Activated | Investigate, reset when safe |
| ALM_ESTOP_PZ | E-Stop Palletizing | Activated | Investigate, reset when safe |
| ALM_GUARD_xx | Safety Guard Open | Open while running | Stop equipment, secure area |
| ALM_LC_xx | Light Curtain Interrupted | During operation | Verify area clear |

#### 7.3.2 Process Alarms by Area

**Liquid Processing:**
| Tag | Description | Setpoint | Priority | Action |
|-----|-------------|----------|----------|--------|
| VAT_xx_TEMP_HH | Vat Temperature Very High | >90C | 2 | Reduce heating, check cooling |
| VAT_xx_TEMP_H | Vat Temperature High | >85C | 3 | Monitor, prepare cooling |
| VAT_xx_TEMP_L | Vat Temperature Low | <30C | 3 | Increase heating |
| VAT_xx_LVL_HH | Vat Level Very High | >95% | 2 | Stop filling immediately |
| VAT_xx_LVL_H | Vat Level High | >90% | 3 | Prepare to stop fill |
| VAT_xx_LVL_LL | Vat Level Very Low | <5% | 2 | Stop agitator, check drain |
| TK_xx_LVL_HH | Tank Level Very High | >95% | 2 | Stop transfer in |
| TK_xx_LVL_LL | Tank Level Very Low | <3% | 3 | Stop transfer out |

**Filler Production:**
| Tag | Description | Setpoint | Priority | Action |
|-----|-------------|----------|----------|--------|
| FL_xx_BOWL_LL | Bowl Level Very Low | <10% | 2 | Stop filler, check supply |
| FL_xx_BOWL_HH | Bowl Level Very High | >95% | 2 | Close supply valve |
| FL_xx_REJ_HIGH | High Reject Rate | >5% | 2 | Reduce speed, investigate |
| FL_xx_VFD_FLT | VFD Fault | Any fault | 2 | Check drive, reset |
| FL_xx_SYNC_ERR | Line Sync Error | Accumulator limit | 3 | Adjust speeds |
| CAP_xx_LVL_L | Cap Hopper Low | <20% | 3 | Refill hopper |

**Packaging:**
| Tag | Description | Setpoint | Priority | Action |
|-----|-------------|----------|----------|--------|
| LAB_xx_EMPTY | Label Roll Empty | End of roll | 3 | Replace roll |
| LAB_xx_VIS_FLT | Vision System Fault | Any fault | 2 | Check camera, clean lens |
| PKG_xx_CASE_L | Case Magazine Low | <10 cases | 3 | Refill magazine |
| SEL_xx_GLUE_FLT | Glue System Fault | Any fault | 2 | Check glue system |

**Palletizing:**
| Tag | Description | Setpoint | Priority | Action |
|-----|-------------|----------|----------|--------|
| ROB_xx_FAULT | Robot Fault | Any fault | 2 | Check robot, reset |
| ROB_xx_GRIP_P_L | Gripper Pressure Low | <4 bar | 2 | Check air supply |
| WRP_xx_FILM_L | Wrapper Film Low | <10% | 3 | Prepare new roll |
| PAL_xx_FULL | Pallet Position Full | Pallet complete | 4 | Remove full pallet |

### 7.4 Alarm Rationalization Guidelines

**Criteria for Valid Alarms:**
1. Indicates an abnormal condition requiring operator response
2. Has a defined response procedure
3. Has appropriate priority based on consequence and urgency
4. Is not duplicated by another alarm
5. Allows adequate time for operator response

**Alarm Rate Targets:**
| Metric | Target | Maximum |
|--------|--------|---------|
| Alarms per hour (average) | <6 | 12 |
| Alarms per hour (peak) | <12 | 24 |
| Standing alarms | <5 | 10 |
| Priority 1 alarms per month | <5 | 10 |

### 7.5 Alarm Shelving and Suppression

**Shelving (Operator):**
- Maximum duration: 8 hours
- Requires reason code selection
- Automatically returns after duration
- Logged with operator ID

**Suppression (Engineering):**
- Used during maintenance, commissioning
- Requires written authorization
- Tracked in MOC system
- Reviewed monthly

**State-Based Suppression:**
- Alarms automatically suppressed when equipment not in relevant state
- Example: Low level alarm suppressed during tank draining
- Configured in alarm logic, not manual

### 7.6 Alarm Response Procedures

Each Priority 1 and Priority 2 alarm shall have a documented Alarm Response Procedure including:
1. Alarm description
2. Possible causes
3. Immediate actions
4. Follow-up actions
5. Notification requirements

**Example Alarm Response Procedure:**

```
ALARM: VAT_01_TEMP_HH - Vat 01 Temperature Very High
PRIORITY: 2 - High
SETPOINT: >90C

POSSIBLE CAUSES:
- Heating valve stuck open
- Temperature control failure
- Cooling water supply failure
- Sensor failure (false alarm)

IMMEDIATE ACTIONS:
1. Verify reading on local gauge
2. If confirmed high:
   a. Place temperature loop in MANUAL
   b. Close heating valve (TV-01-01)
   c. Open cooling water supply
3. If false alarm:
   a. Check sensor for damage
   b. Notify maintenance

FOLLOW-UP ACTIONS:
1. Investigate root cause
2. Notify Quality if product affected
3. Document in shift log
4. Create work order if equipment issue

NOTIFICATIONS:
- Shift Supervisor: Immediate
- Quality: If product above 90C for >5 minutes
- Maintenance: If equipment fault confirmed
```

---

## 8. Appendices

### 8.1 Appendix A: Tag Naming Convention

```
FORMAT: [Area]-[UnitType][UnitNum]-[DeviceType]-[DeviceNum]-[Attribute]

AREA CODES:
  LP = Liquid Processing
  FP = Filler Production
  PK = Packaging
  PZ = Palletizing

UNIT TYPES:
  VAT = Mixing Vat
  TK = Storage Tank
  FL = Filling Line
  LL = Labeler Line
  PAL = Palletizer
  WRP = Wrapper

DEVICE TYPES:
  XV = On/Off Valve
  FCV = Flow Control Valve
  TV = Temperature Valve
  TT = Temperature Transmitter
  LT = Level Transmitter
  FT = Flow Transmitter
  WT = Weight Transmitter
  PT = Pressure Transmitter
  P = Pump
  AG = Agitator
  PE = Photoeye
  VFD = Variable Frequency Drive

EXAMPLES:
  LP-VAT01-TT-01-PV = Liquid Processing, Vat 01, Temperature Transmitter 01, Process Value
  FP-FL01-VFD-02-SPD = Filler Production, Filling Line 01, VFD 02, Speed
```

### 8.2 Appendix B: UNS Topic Mapping

```
UNS TOPIC STRUCTURE:
Enterprise B/Site1/{area}/{unit}/{equipment}/{category}/{tag}

EXAMPLES:
Enterprise B/Site1/liquidprocessing/mixroom01/vat01/processdata/process/temperature
Enterprise B/Site1/liquidprocessing/mixroom01/vat01/processdata/process/weight
Enterprise B/Site1/liquidprocessing/mixroom01/vat01/processdata/state/code
Enterprise B/Site1/liquidprocessing/tankstorage01/tank01/processdata/process/flowrate
Enterprise B/Site1/fillerproduction/fillingline01/filler/processdata/count/outfeed
Enterprise B/Site1/fillerproduction/fillingline01/metric/oee
Enterprise B/Site1/packaging/labelerline01/labeler/processdata/rate/instant
Enterprise B/Site1/palletizing/palletizer01/wrapper/metric/availability

PAYLOAD FORMAT (JSON):
{
  "timestamp": "2026-01-09T10:30:00.000Z",
  "value": 45.2,
  "quality": "GOOD",
  "unit": "C"
}
```

### 8.3 Appendix C: Safety System Summary

| SIF ID | Description | SIL | Initiator | Logic Solver | Final Element |
|--------|-------------|-----|-----------|--------------|---------------|
| SIF-LP-001 | Vat Overfill Protection | 1 | LT-xx-01 (redundant) | LP-SAF-01 | XV-xx-01, XV-xx-02, XV-xx-03 |
| SIF-LP-002 | High Temperature Protection | 1 | TT-xx-01 (redundant) | LP-SAF-01 | TV-xx-01, AG-xx-01 |
| SIF-FP-001 | Filler E-Stop | 2 | E-Stop buttons, Light curtains | FP-SAF-01 | All filler motion |
| SIF-FP-002 | Washer Guard Interlock | 1 | Door switches | FP-SAF-01 | Washer motor |
| SIF-PK-001 | Packager Guard Interlock | 1 | Door switches | PK-SAF-01 | Packager motor |
| SIF-PZ-001 | Robot Cell Protection | 2 | Guard switches, Light curtains | PZ-SAF-01 | Robot enable |

### 8.4 Appendix D: Document Revision History

| Rev | Date | Author | Description |
|-----|------|--------|-------------|
| A | 2026-01-09 | Controls Engineering | Initial release |

---

**END OF DOCUMENT**
